use Modern::Perl 2018;

use CInet::Base;
use CInet::Data::Loader;

use Test::More;
use Test::Deep;

my $N  = [1 .. 5];
my $An = CUBE($N);

is $An, CUBE(5), 'caching works';
is 0+ $An->squares, 80, 'right amount';
cmp_deeply $An->unpack(2, 13), [[1,3],[2,4]], 'variable no. 13 in dimension 5';

sub faces_txt {
    my ($n, $meth) = @_;
    join '', map { '['. FACE .']'."\n" } CUBE($n)->$meth
}

# Exhaustive tests for all files from gaussoids.de
is faces_txt(3, 'squares'), data_file('squares3.txt'), 'ordering of 3-squares';
is faces_txt(4, 'squares'), data_file('squares4.txt'), 'ordering of 4-squares';
is faces_txt(5, 'squares'), data_file('squares5.txt'), 'ordering of 5-squares';
is faces_txt(6, 'squares'), data_file('squares6.txt'), 'ordering of 6-squares';
is faces_txt(7, 'squares'), data_file('squares7.txt'), 'ordering of 7-squares';

# Not from gaussoids.de, but the same principle.
# We commit to keeping this ordering.
is faces_txt(3, 'vertices'), data_file('vertices3.txt'), 'ordering of 3-vertices';
is faces_txt(4, 'vertices'), data_file('vertices4.txt'), 'ordering of 4-vertices';
is faces_txt(5, 'vertices'), data_file('vertices5.txt'), 'ordering of 5-vertices';
is faces_txt(6, 'vertices'), data_file('vertices6.txt'), 'ordering of 6-vertices';
is faces_txt(7, 'vertices'), data_file('vertices7.txt'), 'ordering of 7-vertices';

done_testing;

__DATA__
@@ vertices3.txt
[|]
[|1]
[|2]
[|3]
[|12]
[|13]
[|23]
[|123]
@@ squares3.txt
[12|]
[12|3]
[13|]
[13|2]
[23|]
[23|1]
@@ vertices4.txt
[|]
[|1]
[|2]
[|3]
[|4]
[|12]
[|13]
[|14]
[|23]
[|24]
[|34]
[|123]
[|124]
[|134]
[|234]
[|1234]
@@ squares4.txt
[12|]
[12|3]
[12|4]
[12|34]
[13|]
[13|2]
[13|4]
[13|24]
[14|]
[14|2]
[14|3]
[14|23]
[23|]
[23|1]
[23|4]
[23|14]
[24|]
[24|1]
[24|3]
[24|13]
[34|]
[34|1]
[34|2]
[34|12]
@@ vertices5.txt
[|]
[|1]
[|2]
[|3]
[|4]
[|5]
[|12]
[|13]
[|14]
[|15]
[|23]
[|24]
[|25]
[|34]
[|35]
[|45]
[|123]
[|124]
[|125]
[|134]
[|135]
[|145]
[|234]
[|235]
[|245]
[|345]
[|1234]
[|1235]
[|1245]
[|1345]
[|2345]
[|12345]
@@ squares5.txt
[12|]
[12|3]
[12|4]
[12|5]
[12|34]
[12|35]
[12|45]
[12|345]
[13|]
[13|2]
[13|4]
[13|5]
[13|24]
[13|25]
[13|45]
[13|245]
[14|]
[14|2]
[14|3]
[14|5]
[14|23]
[14|25]
[14|35]
[14|235]
[15|]
[15|2]
[15|3]
[15|4]
[15|23]
[15|24]
[15|34]
[15|234]
[23|]
[23|1]
[23|4]
[23|5]
[23|14]
[23|15]
[23|45]
[23|145]
[24|]
[24|1]
[24|3]
[24|5]
[24|13]
[24|15]
[24|35]
[24|135]
[25|]
[25|1]
[25|3]
[25|4]
[25|13]
[25|14]
[25|34]
[25|134]
[34|]
[34|1]
[34|2]
[34|5]
[34|12]
[34|15]
[34|25]
[34|125]
[35|]
[35|1]
[35|2]
[35|4]
[35|12]
[35|14]
[35|24]
[35|124]
[45|]
[45|1]
[45|2]
[45|3]
[45|12]
[45|13]
[45|23]
[45|123]
@@ vertices6.txt
[|]
[|1]
[|2]
[|3]
[|4]
[|5]
[|6]
[|12]
[|13]
[|14]
[|15]
[|16]
[|23]
[|24]
[|25]
[|26]
[|34]
[|35]
[|36]
[|45]
[|46]
[|56]
[|123]
[|124]
[|125]
[|126]
[|134]
[|135]
[|136]
[|145]
[|146]
[|156]
[|234]
[|235]
[|236]
[|245]
[|246]
[|256]
[|345]
[|346]
[|356]
[|456]
[|1234]
[|1235]
[|1236]
[|1245]
[|1246]
[|1256]
[|1345]
[|1346]
[|1356]
[|1456]
[|2345]
[|2346]
[|2356]
[|2456]
[|3456]
[|12345]
[|12346]
[|12356]
[|12456]
[|13456]
[|23456]
[|123456]
@@ squares6.txt
[12|]
[12|3]
[12|4]
[12|5]
[12|6]
[12|34]
[12|35]
[12|36]
[12|45]
[12|46]
[12|56]
[12|345]
[12|346]
[12|356]
[12|456]
[12|3456]
[13|]
[13|2]
[13|4]
[13|5]
[13|6]
[13|24]
[13|25]
[13|26]
[13|45]
[13|46]
[13|56]
[13|245]
[13|246]
[13|256]
[13|456]
[13|2456]
[14|]
[14|2]
[14|3]
[14|5]
[14|6]
[14|23]
[14|25]
[14|26]
[14|35]
[14|36]
[14|56]
[14|235]
[14|236]
[14|256]
[14|356]
[14|2356]
[15|]
[15|2]
[15|3]
[15|4]
[15|6]
[15|23]
[15|24]
[15|26]
[15|34]
[15|36]
[15|46]
[15|234]
[15|236]
[15|246]
[15|346]
[15|2346]
[16|]
[16|2]
[16|3]
[16|4]
[16|5]
[16|23]
[16|24]
[16|25]
[16|34]
[16|35]
[16|45]
[16|234]
[16|235]
[16|245]
[16|345]
[16|2345]
[23|]
[23|1]
[23|4]
[23|5]
[23|6]
[23|14]
[23|15]
[23|16]
[23|45]
[23|46]
[23|56]
[23|145]
[23|146]
[23|156]
[23|456]
[23|1456]
[24|]
[24|1]
[24|3]
[24|5]
[24|6]
[24|13]
[24|15]
[24|16]
[24|35]
[24|36]
[24|56]
[24|135]
[24|136]
[24|156]
[24|356]
[24|1356]
[25|]
[25|1]
[25|3]
[25|4]
[25|6]
[25|13]
[25|14]
[25|16]
[25|34]
[25|36]
[25|46]
[25|134]
[25|136]
[25|146]
[25|346]
[25|1346]
[26|]
[26|1]
[26|3]
[26|4]
[26|5]
[26|13]
[26|14]
[26|15]
[26|34]
[26|35]
[26|45]
[26|134]
[26|135]
[26|145]
[26|345]
[26|1345]
[34|]
[34|1]
[34|2]
[34|5]
[34|6]
[34|12]
[34|15]
[34|16]
[34|25]
[34|26]
[34|56]
[34|125]
[34|126]
[34|156]
[34|256]
[34|1256]
[35|]
[35|1]
[35|2]
[35|4]
[35|6]
[35|12]
[35|14]
[35|16]
[35|24]
[35|26]
[35|46]
[35|124]
[35|126]
[35|146]
[35|246]
[35|1246]
[36|]
[36|1]
[36|2]
[36|4]
[36|5]
[36|12]
[36|14]
[36|15]
[36|24]
[36|25]
[36|45]
[36|124]
[36|125]
[36|145]
[36|245]
[36|1245]
[45|]
[45|1]
[45|2]
[45|3]
[45|6]
[45|12]
[45|13]
[45|16]
[45|23]
[45|26]
[45|36]
[45|123]
[45|126]
[45|136]
[45|236]
[45|1236]
[46|]
[46|1]
[46|2]
[46|3]
[46|5]
[46|12]
[46|13]
[46|15]
[46|23]
[46|25]
[46|35]
[46|123]
[46|125]
[46|135]
[46|235]
[46|1235]
[56|]
[56|1]
[56|2]
[56|3]
[56|4]
[56|12]
[56|13]
[56|14]
[56|23]
[56|24]
[56|34]
[56|123]
[56|124]
[56|134]
[56|234]
[56|1234]
@@ vertices7.txt
[|]
[|1]
[|2]
[|3]
[|4]
[|5]
[|6]
[|7]
[|12]
[|13]
[|14]
[|15]
[|16]
[|17]
[|23]
[|24]
[|25]
[|26]
[|27]
[|34]
[|35]
[|36]
[|37]
[|45]
[|46]
[|47]
[|56]
[|57]
[|67]
[|123]
[|124]
[|125]
[|126]
[|127]
[|134]
[|135]
[|136]
[|137]
[|145]
[|146]
[|147]
[|156]
[|157]
[|167]
[|234]
[|235]
[|236]
[|237]
[|245]
[|246]
[|247]
[|256]
[|257]
[|267]
[|345]
[|346]
[|347]
[|356]
[|357]
[|367]
[|456]
[|457]
[|467]
[|567]
[|1234]
[|1235]
[|1236]
[|1237]
[|1245]
[|1246]
[|1247]
[|1256]
[|1257]
[|1267]
[|1345]
[|1346]
[|1347]
[|1356]
[|1357]
[|1367]
[|1456]
[|1457]
[|1467]
[|1567]
[|2345]
[|2346]
[|2347]
[|2356]
[|2357]
[|2367]
[|2456]
[|2457]
[|2467]
[|2567]
[|3456]
[|3457]
[|3467]
[|3567]
[|4567]
[|12345]
[|12346]
[|12347]
[|12356]
[|12357]
[|12367]
[|12456]
[|12457]
[|12467]
[|12567]
[|13456]
[|13457]
[|13467]
[|13567]
[|14567]
[|23456]
[|23457]
[|23467]
[|23567]
[|24567]
[|34567]
[|123456]
[|123457]
[|123467]
[|123567]
[|124567]
[|134567]
[|234567]
[|1234567]
@@ squares7.txt
[12|]
[12|3]
[12|4]
[12|5]
[12|6]
[12|7]
[12|34]
[12|35]
[12|36]
[12|37]
[12|45]
[12|46]
[12|47]
[12|56]
[12|57]
[12|67]
[12|345]
[12|346]
[12|347]
[12|356]
[12|357]
[12|367]
[12|456]
[12|457]
[12|467]
[12|567]
[12|3456]
[12|3457]
[12|3467]
[12|3567]
[12|4567]
[12|34567]
[13|]
[13|2]
[13|4]
[13|5]
[13|6]
[13|7]
[13|24]
[13|25]
[13|26]
[13|27]
[13|45]
[13|46]
[13|47]
[13|56]
[13|57]
[13|67]
[13|245]
[13|246]
[13|247]
[13|256]
[13|257]
[13|267]
[13|456]
[13|457]
[13|467]
[13|567]
[13|2456]
[13|2457]
[13|2467]
[13|2567]
[13|4567]
[13|24567]
[14|]
[14|2]
[14|3]
[14|5]
[14|6]
[14|7]
[14|23]
[14|25]
[14|26]
[14|27]
[14|35]
[14|36]
[14|37]
[14|56]
[14|57]
[14|67]
[14|235]
[14|236]
[14|237]
[14|256]
[14|257]
[14|267]
[14|356]
[14|357]
[14|367]
[14|567]
[14|2356]
[14|2357]
[14|2367]
[14|2567]
[14|3567]
[14|23567]
[15|]
[15|2]
[15|3]
[15|4]
[15|6]
[15|7]
[15|23]
[15|24]
[15|26]
[15|27]
[15|34]
[15|36]
[15|37]
[15|46]
[15|47]
[15|67]
[15|234]
[15|236]
[15|237]
[15|246]
[15|247]
[15|267]
[15|346]
[15|347]
[15|367]
[15|467]
[15|2346]
[15|2347]
[15|2367]
[15|2467]
[15|3467]
[15|23467]
[16|]
[16|2]
[16|3]
[16|4]
[16|5]
[16|7]
[16|23]
[16|24]
[16|25]
[16|27]
[16|34]
[16|35]
[16|37]
[16|45]
[16|47]
[16|57]
[16|234]
[16|235]
[16|237]
[16|245]
[16|247]
[16|257]
[16|345]
[16|347]
[16|357]
[16|457]
[16|2345]
[16|2347]
[16|2357]
[16|2457]
[16|3457]
[16|23457]
[17|]
[17|2]
[17|3]
[17|4]
[17|5]
[17|6]
[17|23]
[17|24]
[17|25]
[17|26]
[17|34]
[17|35]
[17|36]
[17|45]
[17|46]
[17|56]
[17|234]
[17|235]
[17|236]
[17|245]
[17|246]
[17|256]
[17|345]
[17|346]
[17|356]
[17|456]
[17|2345]
[17|2346]
[17|2356]
[17|2456]
[17|3456]
[17|23456]
[23|]
[23|1]
[23|4]
[23|5]
[23|6]
[23|7]
[23|14]
[23|15]
[23|16]
[23|17]
[23|45]
[23|46]
[23|47]
[23|56]
[23|57]
[23|67]
[23|145]
[23|146]
[23|147]
[23|156]
[23|157]
[23|167]
[23|456]
[23|457]
[23|467]
[23|567]
[23|1456]
[23|1457]
[23|1467]
[23|1567]
[23|4567]
[23|14567]
[24|]
[24|1]
[24|3]
[24|5]
[24|6]
[24|7]
[24|13]
[24|15]
[24|16]
[24|17]
[24|35]
[24|36]
[24|37]
[24|56]
[24|57]
[24|67]
[24|135]
[24|136]
[24|137]
[24|156]
[24|157]
[24|167]
[24|356]
[24|357]
[24|367]
[24|567]
[24|1356]
[24|1357]
[24|1367]
[24|1567]
[24|3567]
[24|13567]
[25|]
[25|1]
[25|3]
[25|4]
[25|6]
[25|7]
[25|13]
[25|14]
[25|16]
[25|17]
[25|34]
[25|36]
[25|37]
[25|46]
[25|47]
[25|67]
[25|134]
[25|136]
[25|137]
[25|146]
[25|147]
[25|167]
[25|346]
[25|347]
[25|367]
[25|467]
[25|1346]
[25|1347]
[25|1367]
[25|1467]
[25|3467]
[25|13467]
[26|]
[26|1]
[26|3]
[26|4]
[26|5]
[26|7]
[26|13]
[26|14]
[26|15]
[26|17]
[26|34]
[26|35]
[26|37]
[26|45]
[26|47]
[26|57]
[26|134]
[26|135]
[26|137]
[26|145]
[26|147]
[26|157]
[26|345]
[26|347]
[26|357]
[26|457]
[26|1345]
[26|1347]
[26|1357]
[26|1457]
[26|3457]
[26|13457]
[27|]
[27|1]
[27|3]
[27|4]
[27|5]
[27|6]
[27|13]
[27|14]
[27|15]
[27|16]
[27|34]
[27|35]
[27|36]
[27|45]
[27|46]
[27|56]
[27|134]
[27|135]
[27|136]
[27|145]
[27|146]
[27|156]
[27|345]
[27|346]
[27|356]
[27|456]
[27|1345]
[27|1346]
[27|1356]
[27|1456]
[27|3456]
[27|13456]
[34|]
[34|1]
[34|2]
[34|5]
[34|6]
[34|7]
[34|12]
[34|15]
[34|16]
[34|17]
[34|25]
[34|26]
[34|27]
[34|56]
[34|57]
[34|67]
[34|125]
[34|126]
[34|127]
[34|156]
[34|157]
[34|167]
[34|256]
[34|257]
[34|267]
[34|567]
[34|1256]
[34|1257]
[34|1267]
[34|1567]
[34|2567]
[34|12567]
[35|]
[35|1]
[35|2]
[35|4]
[35|6]
[35|7]
[35|12]
[35|14]
[35|16]
[35|17]
[35|24]
[35|26]
[35|27]
[35|46]
[35|47]
[35|67]
[35|124]
[35|126]
[35|127]
[35|146]
[35|147]
[35|167]
[35|246]
[35|247]
[35|267]
[35|467]
[35|1246]
[35|1247]
[35|1267]
[35|1467]
[35|2467]
[35|12467]
[36|]
[36|1]
[36|2]
[36|4]
[36|5]
[36|7]
[36|12]
[36|14]
[36|15]
[36|17]
[36|24]
[36|25]
[36|27]
[36|45]
[36|47]
[36|57]
[36|124]
[36|125]
[36|127]
[36|145]
[36|147]
[36|157]
[36|245]
[36|247]
[36|257]
[36|457]
[36|1245]
[36|1247]
[36|1257]
[36|1457]
[36|2457]
[36|12457]
[37|]
[37|1]
[37|2]
[37|4]
[37|5]
[37|6]
[37|12]
[37|14]
[37|15]
[37|16]
[37|24]
[37|25]
[37|26]
[37|45]
[37|46]
[37|56]
[37|124]
[37|125]
[37|126]
[37|145]
[37|146]
[37|156]
[37|245]
[37|246]
[37|256]
[37|456]
[37|1245]
[37|1246]
[37|1256]
[37|1456]
[37|2456]
[37|12456]
[45|]
[45|1]
[45|2]
[45|3]
[45|6]
[45|7]
[45|12]
[45|13]
[45|16]
[45|17]
[45|23]
[45|26]
[45|27]
[45|36]
[45|37]
[45|67]
[45|123]
[45|126]
[45|127]
[45|136]
[45|137]
[45|167]
[45|236]
[45|237]
[45|267]
[45|367]
[45|1236]
[45|1237]
[45|1267]
[45|1367]
[45|2367]
[45|12367]
[46|]
[46|1]
[46|2]
[46|3]
[46|5]
[46|7]
[46|12]
[46|13]
[46|15]
[46|17]
[46|23]
[46|25]
[46|27]
[46|35]
[46|37]
[46|57]
[46|123]
[46|125]
[46|127]
[46|135]
[46|137]
[46|157]
[46|235]
[46|237]
[46|257]
[46|357]
[46|1235]
[46|1237]
[46|1257]
[46|1357]
[46|2357]
[46|12357]
[47|]
[47|1]
[47|2]
[47|3]
[47|5]
[47|6]
[47|12]
[47|13]
[47|15]
[47|16]
[47|23]
[47|25]
[47|26]
[47|35]
[47|36]
[47|56]
[47|123]
[47|125]
[47|126]
[47|135]
[47|136]
[47|156]
[47|235]
[47|236]
[47|256]
[47|356]
[47|1235]
[47|1236]
[47|1256]
[47|1356]
[47|2356]
[47|12356]
[56|]
[56|1]
[56|2]
[56|3]
[56|4]
[56|7]
[56|12]
[56|13]
[56|14]
[56|17]
[56|23]
[56|24]
[56|27]
[56|34]
[56|37]
[56|47]
[56|123]
[56|124]
[56|127]
[56|134]
[56|137]
[56|147]
[56|234]
[56|237]
[56|247]
[56|347]
[56|1234]
[56|1237]
[56|1247]
[56|1347]
[56|2347]
[56|12347]
[57|]
[57|1]
[57|2]
[57|3]
[57|4]
[57|6]
[57|12]
[57|13]
[57|14]
[57|16]
[57|23]
[57|24]
[57|26]
[57|34]
[57|36]
[57|46]
[57|123]
[57|124]
[57|126]
[57|134]
[57|136]
[57|146]
[57|234]
[57|236]
[57|246]
[57|346]
[57|1234]
[57|1236]
[57|1246]
[57|1346]
[57|2346]
[57|12346]
[67|]
[67|1]
[67|2]
[67|3]
[67|4]
[67|5]
[67|12]
[67|13]
[67|14]
[67|15]
[67|23]
[67|24]
[67|25]
[67|34]
[67|35]
[67|45]
[67|123]
[67|124]
[67|125]
[67|134]
[67|135]
[67|145]
[67|234]
[67|235]
[67|245]
[67|345]
[67|1234]
[67|1235]
[67|1245]
[67|1345]
[67|2345]
[67|12345]
